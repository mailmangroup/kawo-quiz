var data = {
	questions: [{"answer": "true", "question": {"en": "Is it true that Trump sold an apartment in China for 15 million dollars?", "zh": "\u7279\u6717\u666e\u5728\u4e2d\u56fd\u4ee51\u5343500\u4e07\u7f8e\u5143\u7684\u4ef7\u683c\u5356\u4e86\u4e00\u95f4\u516c\u5bd3\u662f\u4e0d\u662f\u771f\u7684\uff1f"}, "id": 5, "response": {"en": "He did and this is one of the reasons why he says he really loves China!", "zh": "\u4ed6\u786e\u5b9e\u505a\u4e86\uff0c\u8fd9\u4e5f\u662f\u4ed6\u8bf4\u4ed6\u559c\u6b22\u4e2d\u56fd\u7684\u539f\u56e0\u4e4b\u4e00\u3002"}}, {"answer": "false", "question": {"en": "Trump said: \u201cWe\u2019re going to get Apple to start building their damn computers and things in this country instead of in other countries\u201d. Would it be better if Apple products were manufactured in America?", "zh": "\u201c\u6211\u4eec\u5c06\u8ba9\u82f9\u679c\u516c\u53f8\n\u5728\u7f8e\u56fd\u751f\u4ea7\u4ed6\u4eec\u7684\u7535\u8111\u548c\u5176\u4ed6\u4ea7\u54c1\uff0c\n\u800c\u4e0d\u662f\u5728\u5176\u4ed6\u56fd\u5bb6\u201d\n\u82f9\u679c\u516c\u53f8\u5728\u7f8e\u56fd\u751f\u4ea7\u52a0\u5de5\u4ed6\u4eec\u7684\u4ea7\u54c1\n\u662f\u4e0d\u662f\u66f4\u597d"}, "id": 2, "response": {"en": "It isn't just that workers have a competitive price in China: they are better trained and faster, making it impossible to compete with. If Apple products were manufactured in the U.S., it would cost 3 times more - bad idea Mr. Trump!", "zh": "\u4e2d\u56fd\u4e0d\u4f46\u62e5\u6709\u5ec9\u4ef7\u7684\u52b3\u52a8\u529b,\n\u90a3\u91cc\u7684\u5de5\u4eba\u4e5f\u66f4\u52a0\u8bad\u7ec3\u6709\u7d20,\u505a\u4e8b\u60c5\n\u4e5f\u66f4\u5feb,\u8fd9\u6837\u624d\u8ba9\u4ed6\u4eec\u5145\u6ee1\u7ade\u4e89\u529b\n\u5982\u679c\u82f9\u679c\u4ea7\u54c1\u662f\u5728\u7f8e\u56fd\u751f\u4ea7\u7684,\n\u90a3\u5c06\u4f1a\u6d88\u8017\u4e09\u500d\u7684\u6210\u672c\u3002\n\u6240\u4ee5\u7279\u6717\u666e\u5148\u751f\uff0c\n\u90a3\u53ef\u4e0d\u662f\u4e2a\u597d\u4e3b\u610f"}}, {"answer": "true", "question": {"en": "Trump said: \"By the way, Libya supplies the oil for China. We (America) get no oil from Libya\u201d. Is he right?", "zh": "\u7279\u6717\u666e\u8bf4\u5230\uff0c \u201c\u53e6\u5916\uff0c\u5229\u6bd4\u4e9a\u4e3a\u4e2d\u56fd\u63d0\u4f9b\u539f\u6cb9\uff0c\u4f46\u5374\u5e76\u6ca1\u6709\u4e3a\u6211\u4eec\uff08\u7f8e\u56fd\uff09\u63d0\u4f9b\u3002\u201d"}, "id": 8, "response": {"en": "While Libya does supply some oil to China, the U.S. gets some of its oil from Libya too.", "zh": "\u5c3d\u7ba1\u5229\u6bd4\u4e9a\u786e\u5b9e\u4e3a\u4e2d\u56fd\u63d0\u4f9b\u4e86\u90e8\u5206\u7684\u539f\u6cb9\uff0c\u4f46\u7f8e\u56fd\u4e5f\u4ece\u5229\u6bd4\u4e9a\u90a3\u91cc\u5f97\u5230\u4e86\u90e8\u5206\u539f\u6cb9\u4f9b\u5e94\n\n"}}, {"answer": "true", "question": {"en": "True or false: Trump once compared Chinese leaders to Tom Brady and the New England Patriots.", "zh": "\u7279\u6717\u666e\u6709\u4e00\u6b21\u62ff\u4e2d\u56fd\u7684\u9886\u5bfc\u4eba\u4e0e\u6c64\u59c6 \u5e03\u62c9\u8fea\u4ee5\u53ca\u65b0\u82f1\u683c\u5170\u7231\u56fd\u8005\u6bd4\u8f83\n"}, "id": 9, "response": {"en": "When comparing \u201csmarter\u201d Chinese leaders to American leaders, Trump said it was like Tom Brady and the Patriots playing your high school football team.", "zh": "\u5f53\u6bd4\u8f83\u201c\u66f4\u806a\u660e\u7684\u201d\u4e2d\u56fd\u9886\u5bfc\u4eba\u4e0e\u7f8e\u56fd\u9886\u5bfc\u4eba\u65f6\uff0c\u7279\u6717\u666e\u8bf4\u8fd9\u5c31\u597d\u50cf\u6c64\u59c6\u5e03\u62c9\u8fea\u548c\u7231\u56fd\u8005\u4eec\u5728\u9ad8\u4e2d\u6a44\u6984\u7403\u961f\u73a9\u4e00\u6837"}}, {"answer": "false", "question": {"en": "Donald Trump once claimed \u201cThe concept of global warming was created by and for the Chinese in order to make U.S. manufacturing non-competitive.\u201d Is this actually the case?", "zh": "\u5168\u7403\u53d8\u6696\u7684\u6982\u5ff5\u662f\u4e2d\u56fd\u4eba\u521b\u9020\u51fa\u6765\u7684\uff0c\u4e3a\u7684\u662f\u8ba9\u7f8e\u56fd\u7684\u5236\u9020\u4e1a\u5931\u53bb\u7ade\u4e89\u529b\n\u8fd9\u662f\u5bf9\u7684\u8fd8\u662f\u9519\u7684\uff1f"}, "id": 4, "response": {"en": "It is true that China has had big impact on global warming, but it\u2019s not the only country responsible for it. The Chinese 13th five-year plan aims to ban logging forests completely, which is a very big step in reducing carbon dioxide emissions.", "zh": "\u786e\u5b9e\u4e2d\u56fd\u5728\u5168\u7403\u53d8\u6696\u7684\u8fdb\u7a0b\u4e2d\u5f71\u54cd\u5de8\u5927\uff0c\u4f46\u4e2d\u56fd\u8fd9\u5e76\u4e0d\u662f\u552f\u4e00\u8be5\u5bf9\u5168\u7403\u53d8\u6696\u8d1f\u8d23\u7684\u56fd\u5bb6\u3002\u4e2d\u56fd\u7684\u201c\u5341\u4e09\u4e94\u8ba1\u5212\u201d\u4e2d\u6307\u51fa\uff0c\u7981\u6b62\u5927\u89c4\u6a21\u780d\u4f10\u68ee\u6797\uff0c\u8fd9\u662f\u4e3a\u51cf\u5c11\u4e8c\u6c27\u5316\u78b3\u6392\u653e\u91cf\u8fc8\u51fa\u7684\u4e00\u5927\u6b65\u3002"}}, {"answer": "false", "question": {"en": "Trump once accused China saying, \"They manipulate the hell out of their currency, which just kills us.\" Is he correct?", "zh": "\u4ed6\u4eec\u62fc\u547d\u64cd\u7eb5\u4ed6\u4eec\u7684\u8d27\u5e01\uff0c\n\u90a3\u6837\u8db3\u4ee5\u6740\u6b7b\u6211\u4eec"}, "id": 3, "response": {"en": "From 1995-2014 the yuan has been appreciating, with an exchange rate to USD of 34% since 2007. In fact, China has recently opened its currency value to be determined by the market, showing a reduction in currency manipulation.", "zh": "1995\u5e74-2014\u5e74,\n\u4eba\u540d\u5e01\u4e00\u76f4\u5728\u5347\u503c,\u4ece2007\u5e74\u4ee5\u6765\n\u4eba\u540d\u5e01\u548c\u7f8e\u5143\u7684\u6c47\u7387\u662f34%\uff0c\n\u4e8b\u5b9e\u4e0a\u4e2d\u56fd\u8fd1\u6765\n\u5f00\u653e\u4e86\u4ed6\u4eec\u7684\u6c47\u7387\u653f\u7b56\n\u6539\u7531\u5e02\u573a\u51b3\u5b9a,\u901a\u8fc7\u6c47\u7387\u64cd\u63a7\uff0c\n\u4ed6\u4eec\u7684\u6c47\u7387\u76f4\u7ebf\u4e0b\u964d\u3002"}}, {"answer": "false", "question": {"en": "Donald Trump Claims \u201cthe TPP is a Nefarious Plot by China.\" Is this a fair assessment?", "zh": "\u5510\u7eb3\u5fb7 \u7279\u6717\u666e\u58f0\u79f0\n\"\u6cdb\u592a\u5e73\u6d0b\u4f19\u4f34\u5173\u7cfb\u534f\u8bae\"\u7ec4\u7ec7\n\u662f\u4e2d\u56fd\u7684\u4e00\u4e2a\u90aa\u6076\u7684\u9634\u8c0b"}, "id": 1, "response": {"en": "The Trans-Pacific Partnership, if approved, would eliminate more than 18,000 taxes on American products across the 11 countries that are a part of the deal - and China isn't one of them!", "zh": "\"\u6cdb\u592a\u5e73\u6d0b\u4f19\u4f34\u5173\u7cfb\u534f\u8bae\"\u7ec4\u7ec7\uff0c\n\u5982\u679c\u901a\u8fc7\u7684\u8bdd\u5c06\u4f1a\u51cf\u514d\u7f8e\u56fd\n\u5bf911\u4e2a\u56fd\u5bb6\u7684\u591a\u4e8e18000\u7684\u7a0e,\n\u7136\u800c\u4e2d\u56fd\u5e76\u4e0d\u662f\u4ed6\u4eec\u4e2d\u7684\u4e00\u4e2a"}}, {"answer": "false", "question": {"en": "Trump declared: \u201cI\u2019ll bring back our jobs from China, from Mexico, from Japan, from so many places. I\u2019ll bring back our jobs, and I\u2019ll bring back our money.\u201d Is this possible?", "zh": "\u7279\u6717\u666e\u58f0\u79f0,\u201c\u6211\u4f1a\u628a\u5c5e\u4e8e\u6211\u4eec\n\u7f8e\u56fd\u4eba\u7684\u5de5\u4f5c\u4ece\u4e2d\u56fd,\u4ece\u58a8\u897f\u54e5,\n\u65e5\u672c\u4ee5\u53ca\u5176\u4ed6\u5730\u65b9\u5e26\u56de\u5230\u7f8e\u56fd\n,\u6211\u4f1a\u5e26\u56de\u6211\u4eec\u7684\u5de5\u4f5c,\u8fd8\u6709\u5c5e\u4e8e\n\u6211\u4eec\u7684\u94b1\u201d\n\u8fd9\u662f\u53ef\u80fd\u7684\u5417\uff1f"}, "id": 10, "response": {"en": "Many economists find this \u201ccompletely implausible\u201d. Technology has taken many of those jobs for good. Today\u2019s high-tech factories employ a fraction of the workers they used to. Now, even China is losing some of their low wage manufacturing jobs to countries like Bangladesh and Vietnam.", "zh": "\u8bb8\u591a\u7ecf\u6d4e\u5b66\u5bb6\u90fd\u8bf4,\n\u8fd9\u662f\u5b8c\u5168\u4e0d\u53ef\u80fd\u7684\u3002\n\u79d1\u6280\u5df2\u7ecf\u8ba9\u5f88\u591a\u5de5\u4f5c\u90fd\u4e0d\u590d\u5b58\u5728\n\u5982\u4eca\u7684\u9ad8\u79d1\u6280\u5de5\u5382\u53ea\u96c7\u7528\u4e86\u8fc7\u53bb\n\u5de5\u5382\u7684\u90e8\u5206\u5de5\u4eba\n\u73b0\u5728\u751a\u81f3\u4e2d\u56fd\u4e5f\u5931\u53bb\u4e86\u4e00\u4e9b\u4f4e\u62a5\u916c\n\u7684\u5236\u9020\u4e1a\u7684\u5de5\u4f5c\u3002\u8fd9\u4e9b\u5de5\u4f5c\u6d41\u5411\u4e86\n\u50cf\u5b5f\u52a0\u62c9\u56fd\u8d8a\u5357\u8fd9\u6837\u7684\u56fd\u5bb6\u3002"}}, {"answer": "false", "question": {"en": "Trump said that \u201cIt's very, very hard to come into China. And yet, we welcome them with open arms\u201d. Is he right about this?", "zh": "\u7279\u6717\u666e\u8bf4\uff1a\u60f3\u8981\u8d70\u8fdb\u4e2d\u56fd\u662f\u5f88\u96be\u7684\uff0c\u7136\u800c\u4ed6\u5374\u5f20\u5f00\u53cc\u81c2\u6b22\u8fce\u4e2d\u56fd\u3002\u8fd9\u662f\u771f\u662f\u5047"}, "id": 7, "response": {"en": "China has protectionist policies, especially when it comes to foreign companies. The U.S. can be considered more \u201copen\u201d when it comes to trade policies, but each country has its own system making it difficult to compare.\n", "zh": "\u4e2d\u56fd\u6709\u7740\u4fdd\u62a4\u4e3b\u4e49\u653f\u7b56\uff0c\u5c24\u5176\u662f\u9762\u5bf9\u5916\u8d44\u4f01\u4e1a\u7684\u65f6\u5019\u3002\u5c31\u8d38\u6613\u653f\u7b56\u6765\u8bf4\u7f8e\u56fd\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662f\u66f4\u5f00\u653e\u7684\u3002\u4f46\u662f\u6bcf\u4e2a\u56fd\u5bb6\u90fd\u6709\u4ed6\u4eec\u81ea\u8eab\u7684\u4f53\u7cfb\uff0c\u8fd9\u4e5f\u8ba9\u56fd\u5bb6\u4e4b\u95f4\u7684\u653f\u7b56\u53d8\u7684\u4e0d\u53ef\u6bd4\u8f83\u3002"}}, {"answer": "false", "question": {"en": "Trump boasted that he would raise the tariff on Chinese exports to the United States to 45% in order to reduce competitivity in trading market. Would this benefit world trade?", "zh": "\u7279\u6717\u666e\u8bf4\u4ed6\u4f1a\u5bf9\u4e2d\u56fd\u51fa\u53e3\u7f8e\u56fd\u7684\u5546\u54c1\n\u4e0a\u8c03\u81f345%\u7684\u5173\u7a0e\uff0c\n\u4e3a\u7684\u662f\u51cf\u5c11\u4ea4\u6613\u5e02\u573a\u7684\u7ade\u4e89,\n\u8fd9\u5bf9\u4e16\u754c\u8d38\u6613\u4f1a\u6709\u76ca\u5904\u5417\uff1f"}, "id": 6, "response": {"en": "We\u2019re all looking for a better quality and price, so why would we want to pay more money for goods made in China? \nChina produces about 80% of the world\u2019s air-conditioners, 70% of its mobile phones and 60% of its shoes. So, if you love \u201cchilling\u201d with your iPhone and new shoes, let\u2019s keep it how it is!", "zh": "\u6211\u4eec\u90fd\u5e0c\u671b\u4e2d\u56fd\u5236\u9020\u7684\u5546\u54c1\n\u8d28\u91cf\u66f4\u597d\u4e5f\u66f4\u4fbf\u5b9c\uff0c\n\u90a3\u4e48\u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u4e3a\u4e2d\u56fd\u5236\u9020\u7684\u5546\n\u54c1\u4ed8\u66f4\u591a\u7684\u94b1\u5462\uff1f\n\u4e2d\u56fd\u5236\u9020\u7684\u5546\u54c1\u5360\u636e\u4e86\n\u4e16\u754c\u7a7a\u8c03\u5e02\u573a\u768480%\uff0c\n\u624b\u673a\u5e02\u573a\u768470%\n\u978b\u5b50\u5e02\u573a\u768460%,\u5982\u679c\u4f60\u8fd8\u60f3\n\u591a\u5c1d\u8bd5\u65b0\u7684iphone\u6216\u8005\u65b0\u978b\u5b50\n\u90a3\u6211\u4eec\u8fd8\u662f\u4fdd\u6301\u73b0\u6709\u7684\u72b6\u6001\u5427"}}]
}

var images = {
	question: [
		'q1.png',
		'q2.png',
		'q3.png',
		'q4.png',
		'q5.png',
		'q6.png',
		'q7.png',
		'q8.png',
		'q9.png',
		'q10.png'
	],
	correct: [
		'g1.gif',
		'g2.gif',
		'g3.gif',
		'g4.gif',
		'g5.gif',
		'g6.gif',
		'g7.gif',
		'g8.gif'
	],
	incorrect: [
		'b1.gif',
		'b2.gif',
		'b3.gif',
		'b4.gif',
		'b5.gif',
		'b6.gif',
		'b7.gif',
		'b8.gif',
	]
}

var seenImages = {
	question: [],
	correct: [],
	incorrect: []
}

// LOAD LANGUAGE BASED ON HASHBANG, FOR SHARING
var lang = 'en';
if(location.hash && location.hash == '#zh')
	lang = 'zh';


// HELPER FUNCTION
// PICK AN IMAGE THAT HASNT BEEN SEEN TO DISPLAY
// ===============================================================================
function imageSelect ( options ) {

	/*if ( images && images.hasOwnProperty(options) ) {

		for ( var i = 0; i < images[ options ].length; i++ ) {

			// GENERATE INDEX BETWEEN 0 AND IMAGE ARRAY LENGTH
			var random = Math.floor( Math.random() * images[ options ].length );

			// IF THE IMAGE HASNT BEEN SEEN BEFORE › PUSH SELECTED IMAGE TO ARRAY AND RETURN IMAGE
			if ( seenImages[ options ].indexOf( images[ options ][ random ] ) === -1 ) {

				// PUSH IMAGE URL TO SEEN IMAGES ARRAY
				seenImages[ options ].push( images[ options ][ random ] );

				// RETURN THE IMAGE
				return images[ options ][ random ];

			}

		}

	}*/
	
	// wouldn't the following be much more efficient? :
	if( images && images.hasOwnProperty(options) ) {

		// GENERATE INDEX BETWEEN 0 AND IMAGE ARRAY LENGTH
		var random = Math.floor( Math.random() * images[ options ].length );

		// GET THE IMAGE URL FROM THE ARRAY
		var img = images[ options ][ random ];
		
		// PUSH IMAGE URL TO SEEN IMAGES ARRAY
		seenImages[ options ].push( img );

		// REMOVE THE CHOSEN IMAGE FROM THE IMAGES ARRAY
		seenImages[ options ].splice( random, 1 );

		// RETURN THE IMAGE
		return img;
	
	}

}

// CREATE SCREEN FUNCTION
// ===============================================================================
function Screen ( textElement , image ) {

	this.el = document.createElement( 'section' );
	this.el.className = 'main-wrapper';

	this.article = document.createElement( 'article' );
	this.el.appendChild( this.article );

	this.textWrapper = document.createElement( 'div' );
	this.text = {};

	this.text.zh = document.createElement( textElement );
	this.text.en = document.createElement( textElement );

	this.choiceList = document.createElement( 'div' );
	this.choiceList.className = 'btn-list';

	if(image){
		this.image = document.createElement( 'img' );
		this.image.className = 'img-full';
		this.image.src = image;
		this.article.appendChild( this.image );
	}

	this.article.appendChild( this.textWrapper );
	if(lang == 'zh')
		this.textWrapper.appendChild( this.text.zh );
	else
		this.textWrapper.appendChild( this.text.en );
	this.article.appendChild( this.choiceList );

	return this;

}

function progressBar( ) {

	this.el = document.createElement( 'div' );
	this.inner = document.createElement( 'div' );
	this.text = document.createElement( 'span' );
	this.el.className = 'progress-bar';
	this.inner.className = 'progress-bar-inner';
	this.el.appendChild( this.inner );
	this.el.appendChild( this.text );

	return this;

}


// CREATE QUIZ OBJECT
// ===============================================================================
var quiz = {

	data: data,

	currentQuestion: 0,

	correct: [],

	incorrect: [],

	// UPDATE PROGRESS BAR FUNCTION
	// ===============================================================================
	updateBar: function ( bar, question, dataLength ) {

		bar.text.innerHTML = ( parseInt( question ) + 1 ) + ' / ' + dataLength;
		bar.inner.style.width = ( ( parseInt( question ) + 1 ) / dataLength ) * 100 + '%';

		return bar;

	},

	// BUILD QUIZ PAGE FUNCTION
	// ===============================================================================
	init: function (  ) {

		// PREVENT SCROLL ON IPHONES TO DISABLE OVERFLOW JUMP
		document.ontouchmove = function( e ) { e.preventDefault(); }

		// IF THERE ARE ALREADY ANSWERS BUT NO PROGRESS IN LOCALSTORAGE › REMOVE ANSWERS FROM LOCALSTORAGE
		if ( localStorage.getItem( 'answers' ) && !localStorage.getItem( 'progress' ) ) localStorage.removeItem( 'answers' );

		// CREATE PROGRESS BARS
		this.progress = new progressBar();

		this.shadowBar = new progressBar();

		// IF LAST QUESTION ANSWERED BUT DIDNT CLICK FINISH › RUN FINISH FUNCTION
		if ( localStorage.getItem( 'progress' ) && this.data.questions.length === localStorage.getItem( 'progress' ).length ) {

			var results = JSON.parse( localStorage.getItem( 'answers' ) );

			window.ga && ga( 'send', 'event', 'finish-quiz', 'Finish Quiz', results.correct.length.toString() + '/' + ( results.correct.length + results.incorrect.length ).toString() );

			window.mixpanel && mixpanel.track( 'finish-quiz', { question: 'Finish Quiz', label: results.correct.length.toString() + '/' + ( results.correct.length + results.incorrect.length ).toString(), } );

			this.finishQuiz( results.correct );

		}

		// RUN FIRST NEXT QUESTION CALL ON INIT
		this.setQuestion( this.data, document.getElementById( 'target' ) );

		var intro = document.getElementById( 'intro-screen' );

		if ( intro ) setTimeout( function () { intro.parentNode.removeChild( intro ); }, 1200 );

		return this;

	},


	// NEXT QUESTION FUNCTION
	// ===============================================================================
	setQuestion: function ( data, target ) {

		this.questionScreen = new Screen( 'h2', './images/' + imageSelect( 'question' ) );

		var $this = this,
			theQuestion = data.questions[ this.currentQuestion ],
			screen = this.questionScreen;

		// APPEND PROGRESS BAR
		if ( screen.article && screen.article.parentNode )
			screen.article.parentNode.insertBefore( this.progress.el, screen.article );

		// UPDATE PROGRESS BAR
		this.updateBar( this.progress, this.currentQuestion, data.questions.length );

		// SET TEXT OF QUESTIONS
		screen.text.zh.innerHTML = theQuestion.question.zh;
		screen.text.en.innerHTML = theQuestion.question.en;

		screen.choice = [
			{ label: 'true', text: '&nbsp;' },
			{ label: 'false', text: '&nbsp;' }
		]

		// SET HTML AND EVENT LISTENER OF CHOICES
		// ===========================================================================
		for ( var i = 0; i < screen.choice.length; i ++ ) {

			var choice = screen.choice[ i ];

			// IF NO CHOICE ELEMENT AT INDEX › CREATE CHOICE ELEMENT
			// =======================================================================
			if ( !choice.el ) {

				choice.el = document.createElement( 'div' );
				choice.el.className = 'choice ' + choice.label;
				choice.el.setAttribute( 'data-label', choice.label );

				// CREATE CHOICE BUTTON
				choice.button = document.createElement( 'button' );
				choice.button.className = 'btn';
				choice.button.innerHTML = choice.text;

			}

			// APPEND CHOICE ELEMENT TO CHOICES LIST
			if ( !choice.el.parentNode )
				screen.choiceList.appendChild( choice.el );

			if ( !choice.button.parentNode )
				choice.el.appendChild( choice.button );

			// ADD EVENT LISTENER
			// =======================================================================
			choice.el.addEventListener( 'click', function ( e ) {

				this.classList.add( 'clicked' );

				// SET ANSWERS TO EMPTY ARRAY
				var answers = {
					correct: [],
					incorrect: []
				};

				// IF LOCALSTORAGE ALREADY HAS ANSWERS › SET TO CURRENT LOCALSTORAGE DATA SO THERES NO OVERWRITE
				if ( localStorage.getItem( 'answers' ) )
					answers = JSON.parse( localStorage.getItem( 'answers' ) );

				if ( this.getAttribute( 'data-label' ).toLowerCase() === theQuestion.answer.toLowerCase() ) {

					// PUSH CURRENT QUESTION TO CORRECT ARRAY
					answers.correct.push( $this.currentQuestion );

					// RETURN CORRECT RESPONSE
					$this.correctResponse( theQuestion.response );

					window.ga && ga( 'send', 'event', 'answered-question', 'Question ' + $this.currentQuestion, 'Correct: ' + this.getAttribute( 'data-label' ) );

					window.mixpanel && mixpanel.track( 'answered-question', { question: 'Question ' + $this.currentQuestion, label: 'Correct: ' + this.getAttribute( 'data-label' ), } );

				}

				else {

					// PUSH CURRENT QUESTION TO INCORRECT ARRAY
					answers.incorrect.push( $this.currentQuestion );

					// RETURN WRONG RESPONSE
					$this.incorrectResponse( theQuestion.response );

					window.ga && ga( 'send', 'event', 'answered-question', 'Question ' + $this.currentQuestion, 'Incorrect: ' + this.getAttribute( 'data-label' ) );

					window.mixpanel && mixpanel.track( 'answered-question', { question: 'Question ' + $this.currentQuestion, label: 'Incorrect: ' + this.getAttribute( 'data-label' ), } );

				}

				// LOG ANSWERS ARRAY TO LOCALSTORAGE
				localStorage.setItem( 'answers', JSON.stringify( answers ) );

			});

		}

		this.currentQuestion = parseInt( this.currentQuestion );
		this.currentQuestion += 1;

		// IF THERES A RESPONSE SCREEN OPEN › CLOSE RESPONSE SCEEN
		if ( this.response && this.response.el.parentNode )
			this.closeScreen( $this.response, screen.el );

		// ELSE › APPEND TO BODY
		else {

			document.getElementById( 'target' ).appendChild( screen.el );

			// ADD OPEN CLASS FOR ANIMATION
			setTimeout( function() { screen.el.classList.add( 'open' ); }, 50 );

		}

		return this;

	},


	// RESPONSE SCREEN FUNCTION
	// ===============================================================================
	responseScreen: function ( target ) {

		// LOG CURRENT QUESTION TO LOCALSTORAGE
		if ( localStorage ) localStorage.setItem( 'progress', JSON.stringify( this.currentQuestion ) );

		var $this = this;

		this.response = new Screen( 'h2' );

		// APPEND PROGRESS BAR
		this.response.article.parentNode.insertBefore( this.progress.el, this.response.article );

		// ADD AND APPEND RIGHT/WRONG TEXT
		this.response.header = document.createElement ('h2');

		// ADD AND APPEND IMAGE
		if ( !this.response.image )
			this.response.image = document.createElement( 'img' );

		if ( !this.response.parentNode && this.response.textWrapper.parentNode ){
			this.response.textWrapper.parentNode.insertBefore( this.response.header, this.response.textWrapper );
			this.response.textWrapper.parentNode.insertBefore( this.response.image, this.response.textWrapper );
		}

		// ADD NEXT BUTTON
		// ============================================================================
		this.response.button = document.createElement( 'button' );
		this.response.button.className = 'btn btn-red';
		this.response.choiceList.appendChild( this.response.button );

		// IF NOT LAST QUESTION › SET TEXT OF BUTTON TO REFLECT THAT
		if ( this.currentQuestion < this.data.questions.length )
			this.response.button.innerHTML = (lang == 'zh' ? '下一题' : 'Next Question');

		// ELSE › SET BUTTON TEXT TO FINISH QUIZ
		else this.response.button.innerHTML = (lang == 'zh' ? '结束测试!' : 'Finish Quiz!');

		// ADD CLICK EVENT TO NEXT QUESTION BUTTON
		this.response.button.addEventListener( 'click', function ( ) {

			// IF NOT LAST QUESTION › LOAD NEXT QUESTION ON CLICK
			if ( $this.currentQuestion < $this.data.questions.length ) {

				window.ga && ga( 'send', 'event', 'next-question', 'Question ' + $this.currentQuestion, 'Question ' + $this.currentQuestion );

				window.mixpanel && mixpanel.track( 'next-question', { question: 'Question ' + $this.currentQuestion, label: null, } );

				$this.setQuestion( $this.data, document.getElementById( 'target' ) );

			}

			// ELSE › RUN FINISH QUIZ FUNCTION WITH DATA FROM LOCALSTORAGE
			else {

				// STORE COMPLETED ITEM TO LOCALSTORAGE
				localStorage.setItem( 'completed', JSON.stringify( 'true' ) );

				var results = JSON.parse( localStorage.getItem( 'answers' ) );

				window.ga && ga( 'send', 'event', 'finish-quiz', 'Finish Quiz', results.correct.length.toString() + '/' + ( results.correct.length + results.incorrect.length ).toString() );

				window.mixpanel && mixpanel.track( 'finish-quiz', { question: 'Finish Quiz', label: results.correct.length.toString() + '/' + ( results.correct.length + results.incorrect.length ).toString(), } );

				$this.finishQuiz( results.correct );

			}

		} );

		// CLOSE QUESTION SCREEN AND APPEND RESPONSE SCREEN
		this.closeScreen( this.questionScreen, this.response.el );

		return this;

	},

	closeScreen: function ( theScreenObject, replacement, theScreenElement ) {

		var $this = this;

		// APPEND SHADOW BAR TO SCREEN
		if ( theScreenObject && theScreenObject.article ) theScreenObject.article.parentNode.insertBefore( this.shadowBar.el, theScreenObject.article );
		if ( this.shadowBar ) this.updateBar( this.shadowBar, this.currentQuestion - 1, data.questions.length );

		// APPEND NEW SCREEN TO BODY
		document.getElementById( 'target' ).appendChild( replacement );

		// ADD OPEN CLASS FOR ANIMATION
		setTimeout( function() { replacement.classList.add( 'open' ); }, 50 );

		// CLOSE SCREEN ON ANIMATION FINISH
		setTimeout( function () {

			if ( theScreenObject && theScreenObject.el ) {

				theScreenObject.el.parentNode.removeChild( theScreenObject.el );

			} else if ( theScreenElement ) {

				theScreenElement.parentNode.removeChild( theScreenElement );

			}

		}, 1250 );

	},

	// CORRECT ANSWER FUNCTION
	// ===============================================================================
	correctResponse: function ( response ) {

		this.responseScreen( document.getElementById( 'target' ) );

		var image = imageSelect( 'correct' );

		this.response.image.src = './images/' + image;

		this.response.header.className = 'correct';
		this.response.header.innerHTML = (lang == 'en' ? 'You got it!' : '是啊！');

		this.response.text.zh.innerHTML = '<strong>是啊！</strong>&nbsp;' + response.zh;
		this.response.text.en.innerHTML = '<strong>Correct!</strong>&nbsp;' + response.en;

		return this;

	},


	// WRONG ANSWER FUNCTION
	// ===============================================================================
	incorrectResponse: function ( response ) {

		this.responseScreen( document.getElementById( 'target' ) );

		var image = imageSelect( 'incorrect' );

		this.response.image.src = './images/' + image;

		this.response.header.className = 'incorrect';
		this.response.header.innerHTML = (lang == 'en' ? 'Nope!' : '不是！');

		this.response.text.zh.innerHTML = '<strong>不是！</strong>&nbsp;' + response.zh;
		this.response.text.en.innerHTML = '<strong>Wrong!</strong>&nbsp;' + response.en;

		return this;

	},

	// DISPLAY RESULTS PAGE FUNCTION
	// ===============================================================================
	finishQuiz: function ( correctAnswers ) {

		var $this = this;

		var resultsPage = new Screen( 'h2' );
		resultsPage.el.id = 'splash-screen';
		resultsPage.el.classList.add( 'final-screen' );

		// ADD AND APPEND SHARE CTA
		resultsPage.shareCTA = document.createElement( 'small' );
		resultsPage.shareCTA.className = 'share-wechat';
		resultsPage.shareCTA.innerHTML = '分享该测试!<br>Share the quiz!';
		resultsPage.article.insertBefore( resultsPage.shareCTA, resultsPage.textWrapper );

		// ADD AND APPEND ARROW
		resultsPage.arrow = document.createElement( 'img' );
		resultsPage.arrow.className = 'arrow share-wechat';
		resultsPage.arrow.src = './images/assets/arrow.png';
		resultsPage.article.insertBefore( resultsPage.arrow, resultsPage.choiceList );

		resultsPage.textWrapper.classList.add( 'vertical-center' );

		// ADD AND APPEND IMAGE
		/*resultsPage.image = document.createElement( 'img' );
		resultsPage.image.className = 'normal-image character';
		resultsPage.article.appendChild( resultsPage.image );
		*/

		var moreInformation = document.createElement( 'div' );

		resultsPage.article.appendChild( moreInformation );

		resultsPage.followCTA = document.createElement( 'small' );
		resultsPage.followCTA.innerHTML = '邮人制造。了解更多<br>Produced by Mailman. Learn more'
		resultsPage.followCTA.className = "readmore";
		moreInformation.appendChild( resultsPage.followCTA );

		// ON CLICK OF MORE INFORMATION › OPEN INFORMATION PAGE
		moreInformation.addEventListener( 'click', function() {

			// LOG RESULTS PAGE TO THIS TO BE ACCESSIBLE VIA CLOSE FUNCTION
			$this.resultsPage = resultsPage;

			$this.learnMore();

			window.ga && ga( 'send', 'event', 'learn-more', 'Learn More', 'Learn More' );

			window.mixpanel && mixpanel.track( 'learn-more', { question: 'Learn More', label: null, } );


		});


		// ALTER PAGE ACCORDING TO SCORE
		// ============================================================================

		// DONT LET BE MORE THAN 100% THROUGH LOCAL STORAGE HACKS
		if ( correctAnswers.length > 20 ) var correct = '20';
		else var correct = correctAnswers.length.toString();

		var scoreEn = correct + '/' + this.data.questions.length.toString(),
			scoreZh = this.data.questions.length.toString() + '题中的' + correct;

		// IF THEY SCORED 80% OR HIGHER › DISPLAY WELL DONE PAGE
		if ( correctAnswers.length / this.data.questions.length >= 0.6 ) {

			var levelImage = 'welldone',
				levelMessageEn = '<span class="level-message">Well done</span><br><br>',
				titleMessage = 'I know China better than Donald Trump. Do you? Take the quiz!';

		}

		// ELSE › DISPLAY FIRED PAGE
		else {

			var levelImage = 'fired',
				levelMessageEn = '<span class="level-message">You\'re fired</span><br><br>',
				titleMessage = 'Oh no! Trump knows China better than me!? Take the quiz!';

		}

		// SET INNER HTML OF TEXT
		resultsPage.text.zh.innerHTML = levelMessageEn + '你答对了' + scoreZh;
		resultsPage.text.en.innerHTML = levelMessageEn + 'You scored ' + scoreEn;

		// SET CHARACTER IMAGE URL
		resultsPage.article.className = levelImage;

		// SET NEW TITLE FOR SHARING
		var title = document.querySelectorAll( 'title' )[ 0 ];
		if ( title ) title.innerHTML = titleMessage;

		// CLOSE RESPONSE SCREEN AND APPEND RESULTS SCREEN
		if ( this.responseScreen )
			this.closeScreen( this.responseScreen, resultsPage.el );

		else
			document.getElementById( 'target' ).appendChild( resultsPage.el );

		// IF ON DESKTOP › LOAD FACEBOOK AND TWITTER SHARE ICONS
		if ( window.innerWidth > 641 ) {

			// FACEBOOK SHARE SCRIPT
			(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0];if (d.getElementById(id)) return;js = d.createElement(s); js.id = id;js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));

			// TWITTER SHARE SCRIPT
			!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');

			var shareList = document.createElement( 'ul' ),
				facebookShare = document.createElement( 'li' ),
				twitterShare = document.createElement( 'li' ),
				facebookShareInner = document.createElement( 'div' ),
				twitterShareInner = document.createElement( 'a' ),
				shareTarget = document.getElementById( 'share-target' );

			shareTarget.style.padding = '10px';

			facebookShareInner.className = 'fb-share-button';
			facebookShareInner.setAttribute( 'data-layout', 'button_count' );

			twitterShareInner.className = 'twitter-share-button';
			twitterShareInner.href = 'https://twitter.com/share';
			twitterShareInner.setAttribute( 'data-via', 'kawo' );
			twitterShareInner.innerHTML = 'Tweet';

			shareList.appendChild( facebookShare );
			shareList.appendChild( twitterShare );
			facebookShare.appendChild( facebookShareInner );
			twitterShare.appendChild( twitterShareInner );

			// APPEND SHARE BUTTONS TO SHARE TARGET
			shareTarget.appendChild( shareList );

		}

		return this;

	},

	learnMore: function(  ) {

		var learnMore = new Screen( 'h2' );
		learnMore.el.id = 'splash-screen';
		learnMore.el.classList.add( 'learn-more-screen' );

		learnMore.logo = document.createElement( 'img' );
		learnMore.logo.className = 'logo';
		learnMore.logo.src = './images/assets/logo.png';
		learnMore.textWrapper.parentNode.insertBefore( learnMore.logo, learnMore.textWrapper );

		learnMore.text.zh.innerHTML = '关注我们，即时了解中国最新的数字&社交资讯';
		learnMore.text.en.innerHTML = 'Follow us for the latest in chinese digital and social media';

		// ADD QR CODE
		learnMore.qrCode = document.createElement( 'img' );
		learnMore.qrCode.className = 'normal-image';
		learnMore.qrCode.src = './images/assets/qr-code.png';
		learnMore.article.appendChild( learnMore.qrCode );

		// CLOSE RESPONSE SCREEN AND APPEND RESULTS SCREEN
		if ( this.resultsPage ) this.closeScreen( this.resultsPage.el, learnMore.el );

		else {

			document.body.appendChild( learnMore.el );

			setTimeot( function (  ) {

				learnMore.el.classList.add( 'open' );

				if ( learnMore.el.getBoundingClientRect().height <= 568 ) learnMore.el.classList.add( 'smaller-screen' );

			}, 50 );

		}

		// SET NEW TITLE
		var title = document.querySelectorAll( 'title' )[ 0 ];
		if ( title ) title.innerHTML = 'KAWO Quiz';

	},

}

// ON LOAD › CREATE SPLASH SCREEN OR SET QUESTIONS ACCORINDG TO LOCAL STORAGE
// ===============================================================================
window.onload = function () {

	// IF QUIZ NOT STARTED YET › SET SPLASH SCREEN
	// ============================================================================
	if ( !localStorage.getItem( 'progress' ) && !localStorage.getItem( 'completed' ) ) {

		var splash = new Screen( 'h2' );

		splash.el.id = 'splash-screen';
		splash.el.classList.add( 'landing-screen' );

		splash.el.classList.add( 'open' );

		splash.textWrapper.className = 'splash-text-wrapper';
		splash.text.zh.innerHTML = '你比<br><span>Donald Trump?</span><br>更理解<br><span>中国</span>吗？';
		splash.text.en.innerHTML = 'Do you know <span>China</span><br> better than <span>Donald <br>Trump?</span>';
		splash.text.en.style.textTransform = 'uppercase';

		// ADD NEXT BUTTON
		splash.button = document.createElement( 'button' );
		splash.button.className = 'btn btn-white';
		splash.choiceList.appendChild( splash.button );

		// ADD TEXT TO BUTTON
		splash.button.innerHTML = (lang == 'en' ? 'Take the quiz' : '开始测试');

		// ADD LANGUAGE CHANGE LINK
		splash.langchange = document.createElement( 'a' );
		splash.langchange.href = '#' + (lang == 'en' ? 'zh' : 'en');
		splash.langchange.innerHTML = (lang == 'en' ? '改变中文' : 'English')
		
		splash.langchange.className = 'langchange';
		splash.langchange.addEventListener( 'click', function ( ) {
			window.ga && ga( 'send', 'event', 'change-language', 'click', 'Changed language' );
			window.mixpanel && mixpanel.track( 'change-language' );

			if(lang == 'en')
				lang = 'zh';
			else
				lang = 'en';

			window.onload();
		} );
		splash.choiceList.appendChild( splash.langchange );

		document.getElementById( 'target' ).appendChild( splash.el );

		// IF NOT COMPLETED AND QUIZ WILL INIT › PRELOAD SOME IMAGES
		// ===============================================================================
		var preloaded = [];

		// PRELOAD THE FIRST 10 CORRECT / INCORRECT IMAGES
		// ===============================================================================
		for ( var i = 0; i < 20; i++ ) {

			// IF IN CORRECT LENGTH › PRELOAD CORRECT IMAGES
			if ( i < 11 && images.correct[ i ] ) {

				preloaded[ i ] = new Image()
				preloaded[ i ].src = './images/' + images.correct[ i ];

			}

			// ELSE › PRELOAD INCORRECT IMAGES
			else if ( images.incorrect[ i - 10 ] ) {

				preloaded[ i ] = new Image()
				preloaded[ i ].src = './images/' + images.incorrect[ i - 10 ];

			}

		}

		// START QUIZ
		// ===============================================================================
		splash.button.addEventListener( 'click', function ( ) {

			window.ga && ga( 'send', 'event', 'quiz-started', 'click', 'Quiz started' );

			window.mixpanel && mixpanel.track( 'quiz-started' );

			quiz.init();

			// CLOSE SPLASH SCREEN
			//quiz.closeScreen( null, intro.el, splash.el );

		} );

	}


	// IF PROGRESS MADE IN LOCALSTORAGE BUT QUIZ NOT COMPLETED › JUMP TO LAST QUESTION
	// ============================================================================
	else if ( localStorage.getItem( 'progress' ) && !localStorage.getItem( 'completed' ) ) {

		quiz.currentQuestion = parseInt( localStorage.getItem( 'progress' ) );

		window.ga && ga( 'send', 'event', 'returned-to-quiz', 'Pageview', 'Returned on question: ' + localStorage.getItem( "progress" ) );

		window.mixpanel && mixpanel.track( 'returned-to-quiz', { question: localStorage.getItem( "progress" ), label: null, } );

		quiz.init();

	}

	// IF COMPLETED AND ANSWERS STORED › GENERATE COMPLETION PAGE
	// ============================================================================
	else if ( localStorage.getItem( 'completed' ) && localStorage.getItem( 'answers' ) ) {

		quiz.finishQuiz( JSON.parse( localStorage.getItem( 'answers' ) ).correct );

	}

	// IF ANY UNFORSEEN ROUTE TAKEN › JUST START THE QUIZ
	// ============================================================================
	else {

		localStorage.clear();
		quiz.init();

	}

}